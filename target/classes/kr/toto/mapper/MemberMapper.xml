<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.toto.mapper.MemberMapper">
	<select id="selectOne" resultType="kr.toto.entity.Member" parameterType="kr.toto.entity.Member">
		select * from Member where m_email=#{m_email} and m_pw=#{m_pw}
	</select>
	<insert id="insert" parameterType="kr.toto.entity.Member">
		insert into Member (m_email, m_pw, m_nick, m_like, m_career, m_phone, m_join_date, m_name)
		values (#{m_email}, #{m_pw}, #{m_nick},0, #{m_career}, #{m_phone},now(), #{m_name})
	</insert>
	
	<select id="get"  resultType="kr.toto.entity.Member">
		select * from Member where m_nick = #{m_nick}	
	</select>
	
<update id="updateMember" parameterType="kr.toto.entity.Member">
  update Member
  set m_email = #{m_email},
      m_pw = #{m_pw},
      m_career = #{m_career},
      m_phone = #{m_phone},
      m_name = #{m_name}
  where m_nick = #{m_nick}
</update>
	
	
	<delete id = "remove">
		delete from Member where m_nick= #{m_nick}
	</delete>
	
	<update id="modifyPw" parameterType="kr.toto.entity.Member">
	update Member set m_pw = #{m_pw} where m_nick=#{m_nick}
	</update>
	<insert id="followMember">
		insert into Favor values (#{f_to},#{f_from},now())
	</insert>
	<update id="updateFollowMember">
		<selectKey keyProperty="followerCount" resultType="kr.toto.entity.Favor" order="BEFORE">
		select count(f_to) from Favor where f_to=#{f_to} group by f_to
		</selectKey>
		update Member set m_like = #{follwerCount}
	</update>
	<select id="selectFollower">
		select count(f_to) from Favor where f_to=#{f_to} group by f_to
	</select>
	
</mapper>