<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.toto.mapper.BoardMapper">
	<select id="getAllFile" resultType="kr.toto.entity.Bulletin">
		select * from Bulletin where b_file_or_quiz = 0
	</select>
	<select id="getAllQuiz" resultType="kr.toto.entity.Bulletin">
		select * from Bulletin where b_file_or_quiz = 1
	</select>
	<select id="seeInBoard" resultType="kr.toto.entity.Bulletin"
		parameterType="kr.toto.entity.Bulletin">
		select * from Bulletin where b_num = #{b_num}
	</select>
	
	<insert id="writeBoard" parameterType="kr.toto.entity.Bulletin">
		insert into Bulletin (m_nick, b_file_or_quiz, b_title, b_content,b_date, b_select) values 
		(#{m_nick},#{b_file_or_quiz},#{b_title},#{b_content},now(),0)
	</insert>
	<insert id="writeReple" parameterType="kr.toto.entity.BReple">
		insert into B_reple (b_num, m_nick, r_content, r_date) values
		(#{b_num},#{m_nick},#{r_content},now())
	</insert>
	<!-- <insert id="writeReReple">
		<selectKey keyProperty="r_group" resultType="kr.toto.entity.BReple" order="BEFORE">
		select IFNULL(max(r_group)+1,0) as r_group from B_reple
		</selectKey>
		insert into B_reple (m_nick, r_content, r_date, r_group, r_modify_date, r_parent) values
		(#{m_nick},#{r_content},now(),#{r_group},#{r_modify_date},#{r_parent})
	</insert> -->
	<select id="seeInReple" parameterType="kr.toto.entity.Bulletin"
		resultType="kr.toto.entity.BReple">
		select * from B_reple where (b_num = #{b_num}) order by r_date desc
	</select>
	<select id="searchContent" resultType="kr.toto.entity.Bulletin">
		SELECT * FROM Bulletin WHERE b_content LIKE CONCAT('%', #{search}, '%')
	</select>
	
	<insert id="uploadFile" parameterType="kr.toto.entity.Bulletin" >
		insert into Bulletin(b_content, b_date, b_file_or_quiz, b_select, b_title,  m_nick, b_file)
		values(#{b_content}, now(), #{b_file_or_quiz},  #{b_select}, #{b_title}, #{m_nick},#{b_file})
	</insert>
	
	
	<!-- <select id="searchTitle" resultType="kr.toto.entity.Bulletin">
		select * from Bulletin where b_title like '%#{search}%'
	</select>
	<select id="searchWriter" resultType="kr.toto.entity.Bulletin">
		select * from Bulletin where m_nick like '%#{search}%;
	</select> -->


</mapper>
	
